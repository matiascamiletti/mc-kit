<div class="odata-page">

  <mc-page-heading [breadcrumb]="breadcrumb()" [title]="title()" [subtitle]="subtitle()">

    <div class="flex">
      @if (hasSearch()) {
        <mc-search-field #searchField [key]="key()" [placeholder]="'Search...'" (onSearch)="onSearch($event)" />
      }
      @if(filters()){
        <mc-filter-button [config]="filters()!" (change)="onFilter($event)" class="ml-3" />
      }
      @if (hasEditColumns()) {
        <mc-show-columns-button [initialColumns]="columns()" [key]="key()" (onSelected)="onChangeColumns($event)" class="ml-3" />
      }

    </div>

  </mc-page-heading>

  <div class="odata-content pl-4 pr-4">
    <mc-table [columns]="selectedColumns()" [response]="tableResponse" [paginator]="hasPagination()">

      <ng-container *ngFor="let template of thTemplates()">
        <ng-template mcThTemplate="{{template.getFieldName()}}" let-row let-rowIndex>
          <ng-container [ngTemplateOutlet]="template.template" [ngTemplateOutletContext]="{ $implicit: row, row: row, rowIndex: rowIndex }"></ng-container>
        </ng-template>
      </ng-container>

      <ng-container *ngFor="let template of tdTemplates()">
        <ng-template mcTdTemplate="{{template.getFieldName()}}" let-row let-rowIndex>
          <ng-container [ngTemplateOutlet]="template.template" [ngTemplateOutletContext]="{ $implicit: row, row: row, rowIndex: rowIndex }"></ng-container>
        </ng-template>
      </ng-container>

    </mc-table>
  </div>

</div>
